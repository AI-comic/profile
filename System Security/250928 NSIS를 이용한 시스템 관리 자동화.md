NSIS의 여러 기능을 결합하여, 소프트웨어 설치 및 시스템 설정을 자동화하는 과정

#### 핵심 기능
- **프로세스 제어**: 설치 전 필수적인 프로세스를 종료다.
- **파일 배포**: 설치에 필요한 파일을 특정 경로에 복사다.
- **레지스트리 설정**: 시스템 설정을 변경.
- **시스템 서비스 제어**: 시스템 서비스를 중지하고 다시 시작.
- **외부 프로그램 실행**: 설치 후 사용자에게 결과를 보여주는 프로그램을 실행.

```nsis
; NSIS 스크립트의 일반적인 설정
SetCompressor /SOLID LZMA
Name 'All-in-One NSIS Example'
OutFile 'nsis_utility.exe'
SilentInstall silent

; 필요한 플러그인 포함
!include WinMessages.nsh

Section ""
    ; ===================================
    ; 1. 사전 준비 작업: 프로세스 종료
    ; ===================================
    MessageBox MB_OK "시스템 관리 유틸리티 설치를 시작합니다. 잠시 기다려주세요."
    
    ; notepad.exe 프로세스가 실행 중이면 종료하여 충돌을 방지.
    KillProcDLL::KillProc "notepad.exe"
    DetailPrint "notepad.exe 프로세스 종료 시도..."
    Sleep 500

    ; ===================================
    ; 2. 파일 배포
    ; ===================================
    ; 설치할 README.txt 파일을 임시 폴더에 복사.
    SetOutPath "$TEMP"
    File "README.txt"
    DetailPrint "README.txt 파일이 임시 폴더에 복사되었습니다."

    ; ===================================
    ; 3. 레지스트리 설정
    ; ===================================
    ; 윈도우 로그온 시 나타나는 메시지를 설정하여 보안 고지를 모의.
    WriteRegStr HKLM "Software\Microsoft\Windows\CurrentVersion\Policies\System" "legalnoticecaption" "시스템 관리 알림"
    WriteRegStr HKLM "Software\Microsoft\Windows\CurrentVersion\Policies\System" "legalnoticetext" "이 시스템 설정은 NSIS 스크립트에 의해 변경되었습니다."
    DetailPrint "레지스트리 설정이 완료되었습니다."

    ; ===================================
    ; 4. 시스템 서비스 제어
    ; ===================================
    ; Windows Event Log 서비스를 중지하고 시작하여 서비스 제어 기능을 보여줍니다.
    ExecWait 'net stop EventLog'
    ExecWait 'net start EventLog'
    DetailPrint "Windows Event Log 서비스가 재시작되었습니다."

    ; ===================================
    ; 5. 설치 완료 후 작업: 프로그램 실행
    ; ===================================
    ; 설치된 README.txt 파일을 메모장으로 열어 사용자에게 결과를 보여줍니다.
    Exec '"$WINDIR\System32\notepad.exe" "$TEMP\README.txt"'
    Sleep 2000 ; 메모장이 실행될 시간을 줍니다.

    MessageBox MB_OK "모든 설치 및 설정 작업이 완료되었습니다."

SectionEnd
```

- README.txt 파일 내용 예시:
```
이 파일은 NSIS 스크립트에 의해 성공적으로 배포되었습니다.
- 프로세스 제어
- 파일 배포
- 레지스트리 설정
- 서비스 제어
모든 작업이 완료되었습니다.
```

#### 코드 설명
- `SetCompressor /SOLID LZMA`: **LZMA 압축 알고리즘**을 사용하여 실행 파일의 크기를 줄입니다. `/SOLID`는 여러 파일을 하나의 덩어리로 압축하여 효율을 높입니다.
- `Name 'All-in-One NSIS Example'`: 컴파일된 **인스톨러의 이름**을 지정합니다.
- `OutFile 'nsis_utility.exe'`: 스크립트가 컴파일될 때 생성될 **최종 실행 파일의 이름**을 설정합니다.
- `SilentInstall silent`: 설치 과정이 **사용자의 상호작용 없이** 조용히 진행되도록 합니다.
- `!include WinMessages.nsh`: **Windows 메시지 상수**를 스크립트에서 사용하기 위해 포함합니다.
- `Section "" ... SectionEnd`: NSIS 스크립트의 **실제 실행 코드**가 위치하는 블록입니다.
- `MessageBox MB_OK "..."`: **확인(OK) 버튼**이 있는 메시지 상자를 화면에 띄웁니다.
- `KillProcDLL::KillProc "notepad.exe"`: `KillProcDLL` 플러그인을 사용하여 지정된 프로세스(notepad.exe)를 **강제로 종료**합니다.
- `DetailPrint "..."`: NSIS 인스톨러의 **상세 정보 창**에 메시지를 출력합니다.
- `Sleep 500`: 스크립트 실행을 **500밀리초(0.5초) 동안 일시 정지**합니다.
- `SetOutPath "$TEMP"`: 다음 `File` 명령어가 파일을 추출할 **대상 경로**를 윈도우의 **임시 폴더**(`$TEMP`)로 지정합니다.
- `File "README.txt"`: 스크립트와 동일한 위치에 있는 `README.txt` 파일을 인스톨러에 **포함**시키고, 실행 시 `SetOutPath`로 지정된 경로에 **추출**합니다.
- `WriteRegStr HKLM "..." "..." "..."`: `HKEY_LOCAL_MACHINE` 레지스트리 하위 경로에 **문자열(String) 값**을 추가하거나 변경합니다.
- `ExecWait 'net stop EventLog'`: **외부 명령어를 실행**하고, 해당 명령어가 **완료될 때까지 기다립니다.** 여기서는 `net.exe`를 이용해 `EventLog` 서비스를 **중지**합니다.
- `Exec '"$WINDIR\System32\notepad.exe" "$TEMP\README.txt"'`: 외부 프로그램을 실행하지만, 완료를 **기다리지 않고** 바로 다음 명령어를 실행합니다. `$WINDIR`는 윈도우 설치 경로(예: `C:\Windows`)를 나타내는 내장 변수입니다.
