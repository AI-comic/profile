NSIS 스크립트를 사용하여 설치 과정에서 사용자에게 시각적인 정보를 제공하고, 특정 프로그램을 자동으로 종료하는 등 사용자 경험(UX)을 개선하는 기술을 학습한다.
 
#### 핵심 기능
- **프로세스 종료**: KillProcDLL 플러그인을 사용하여 특정 프로세스를 안전하게 종료한다.
- **스플래시 화면**: advsplash 플러그인을 사용하여 로딩 중 이미지나 메시지를 사용자에게 보여준다.
- **메시지 박스**: MessageBox를 통해 사용자에게 중요한 알림을 전달한다.
- **외부 프로그램 실행**: Exec 명령어를 사용하여 스크립트 외부의 프로그램을 실행한다.

```nsis
; NSIS 스크립트의 일반적인 설정
SetCompressor /SOLID LZMA
Name 'UX Improvement Example'
OutFile 'UX_Example.exe'
SilentInstall silent

; 플러그인 사용을 위한 DLL 포함 (필요 시)
; !include WinMessages.nsh

; 섹션 시작 - 실제 실행될 작업
Section ""
    
    ; 1. 알림 메시지 표시
    ; 사용자에게 작업 시작을 알림.
    MessageBox MB_OK "이제부터 특정 작업을 시작합니다. 잠시 기다려주세요."

    ; 2. 프로세스 종료 (선택적)
    ; KillProcDLL::KillProc 명령어를 사용하여 특정 프로세스를 종료할 수 있음.
    ; 예제에서는 메모장(notepad.exe) 프로세스를 종료.
    ; 이 기능은 프로그램 업데이트 시 기존 버전을 종료할 때 유용함.
    KillProcDLL::KillProc "notepad.exe"
    DetailPrint "notepad.exe 프로세스 종료 시도"
    Sleep 500

    ; 3. 스플래시 화면 표시
    ; 로딩 중 화면을 보여주어 사용자에게 작업이 진행 중임을 알림.
    ; 1초 동안 보여줄 이미지를 임시 폴더에 복사.
    SetOutPath $TEMP
    File /oname=splash_image.bmp "loading_screen.bmp"
    
    ; 스플래시 화면을 3초 동안 보여준다.
    ; advsplash::show <time> <x> <y> <alpha> <image_path>
    advsplash::show 3000 3000 2000 -1 $TEMP\splash_image.bmp
    
    ; 4. 임시 파일 삭제
    ; 사용한 스플래시 이미지를 삭제하여 흔적을 남기지 않는다.
    Delete $TEMP\splash_image.bmp

    ; 5. 외부 프로그램 실행
    ; 모든 작업이 완료된 후 사용자가 원하는 프로그램을 실행.
    ; 예제에서는 다시 메모장 프로그램을 실행.
    Exec '"$WINDIR\System32\notepad.exe"'
    
    ; 6. 완료 메시지 표시
    MessageBox MB_OK "모든 작업이 완료되었습니다."
    
SectionEnd
```
#### 코드 설명
- `KillProcDLL::KillProc "notepad.exe"`: `KillProcDLL` 플러그인을 사용해 `notepad.exe` 프로세스를 종료. 이 명령어는 일반적으로 프로그램 업데이트 시 기존 버전이 실행 중일 경우 충돌을 막기 위해 사용.
- `MessageBox MB_OK "메시지"`: 사용자에게 `OK` 버튼이 있는 팝업 메시지를 보여준다. 이는 스크립트의 현재 상태를 알리는 데 유용.
- `SetOutPath $TEMP`: 다음으로 복사할 파일의 목적지 경로를 Windows의 임시 폴더(`$TEMP`)로 설정.
- `File /oname=splash_image.bmp "loading_screen.bmp"`: 컴파일러가 스크립트와 함께 묶을 `loading_screen.bmp` 파일을 지정하고, 설치 시 임시 폴더에 `splash_image.bmp`라는 이름으로 복사. (실제로 이 스크립트를 사용하려면 `loading_screen.bmp` 파일을 스크립트와 같은 폴더에 준비한다.)
- `advsplash::show 3000 ...`: `advsplash` 플러그인을 사용하여 스플래시 화면을 3초(3000ms) 동안 보여준다. 이를 통해 사용자에게 작업이 진행 중임을 시각적으로 알릴 수 있다.
- `Delete $TEMP\splash_image.bmp`: 작업이 끝난 후 사용했던 임시 파일을 삭제하여 시스템을 깔끔하게 유지.
- `Exec '"$WINDIR\System32\notepad.exe"'`: NSIS 스크립트가 모든 작업을 마친 후, 시스템 폴더에 있는 `notepad.exe`를 실행.

